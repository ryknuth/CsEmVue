using Microsoft.VisualStudio.TestTools.UnitTesting;
using Newtonsoft.Json;
using CsEmVue;

namespace CsEmVueTests
{
    [TestClass]
    public class ResponseDeserialization
    {
        [TestMethod]
        public void GetCustomerResponse()
        {
            var json = "{\"customerGid\":1,\"email\":\"test@test.com\",\"firstName\":\"Hi\",\"lastName\":\"Beau\",\"createdAt\":\"2020 - 05 - 04T20: 34:42.902Z\"}";
            var customer = JsonConvert.DeserializeObject<Customer>(json);
        }

        [TestMethod]
        public void GetDevicesResponse()
        {
            var json = "{\"customerGid\":1,\"email\":\"test@test.com\",\"firstName\":\"Hi\",\"lastName\":\"Beau\",\"createdAt\":\"2020 - 05 - 04T20: 34:42.902Z\",\"devices\":[{\"deviceGid\":10353,\"manufacturerDeviceId\":\"00013c71bf04fc28\",\"model\":\"VUE001\",\"firmware\":\"Vue - 1587661391\",\"parentDeviceGid\":null,\"parentChannelNum\":null,\"locationProperties\":{\"deviceGid\":10353,\"deviceName\":\"House\",\"zipCode\":\"99208\",\"timeZone\":\"America / Los_Angeles\",\"billingCycleStartDay\":1,\"usageCentPerKwHour\":0.07,\"peakDemandDollarPerKw\":0.0,\"locationInformation\":{\"airConditioning\":\"true\",\"heatSource\":\"naturalGasFurnace\",\"locationSqFt\":\"5500\",\"numElectricCars\":\"0\",\"locationType\":\"houseMultiLevel\",\"numPeople\":\"7\"},\"latitudeLongitude\":null,\"utilityRateGid\":null},\"outlet\":null,\"evCharger\":null,\"devices\":[{\"deviceGid\":10353,\"manufacturerDeviceId\":\"SX00013c71bf04fc28\",\"model\":\"WAT001\",\"firmware\":null,\"channels\":[{\"deviceGid\":10353,\"name\":\"AC Main\",\"channelNum\":\"1\",\"channelMultiplier\":2.0,\"channelTypeGid\":1},{\"deviceGid\":10353,\"name\":\"Refrigerator \",\"channelNum\":\"2\",\"channelMultiplier\":1.0,\"channelTypeGid\":10},{\"deviceGid\":10353,\"name\":\"Dryer\",\"channelNum\":\"3\",\"channelMultiplier\":2.0,\"channelTypeGid\":4},{\"deviceGid\":10353,\"name\":\"Oven\",\"channelNum\":\"4\",\"channelMultiplier\":2.0,\"channelTypeGid\":7},{\"deviceGid\":10353,\"name\":\"Freezer\",\"channelNum\":\"5\",\"channelMultiplier\":1.0,\"channelTypeGid\":10},{\"deviceGid\":10353,\"name\":\"AC Up\",\"channelNum\":\"6\",\"channelMultiplier\":1.0,\"channelTypeGid\":1},{\"deviceGid\":10353,\"name\":\"Furnace Up\",\"channelNum\":\"7\",\"channelMultiplier\":1.0,\"channelTypeGid\":11},{\"deviceGid\":10353,\"name\":\"Office\",\"channelNum\":\"8\",\"channelMultiplier\":1.0,\"channelTypeGid\":6}]}],\"channels\":[{\"deviceGid\":10353,\"name\":null,\"channelNum\":\"1,2,3\",\"channelMultiplier\":1.0,\"channelTypeGid\":null}]},{\"deviceGid\":10366,\"manufacturerDeviceId\":\"00013c71bf04fc20\",\"model\":\"VUE001\",\"firmware\":\"Vue - 1587661391\",\"parentDeviceGid\":null,\"parentChannelNum\":null,\"locationProperties\":{\"deviceGid\":10366,\"deviceName\":\"Shop\",\"zipCode\":null,\"timeZone\":\"America / Los_Angeles\",\"billingCycleStartDay\":1,\"usageCentPerKwHour\":13.2,\"peakDemandDollarPerKw\":0.0,\"locationInformation\":null,\"latitudeLongitude\":null,\"utilityRateGid\":null},\"outlet\":null,\"evCharger\":null,\"devices\":[{\"deviceGid\":10366,\"manufacturerDeviceId\":\"SX00013c71bf04fc20\",\"model\":\"WAT001\",\"firmware\":null,\"channels\":[{\"deviceGid\":10366,\"name\":\"Bath Heater\",\"channelNum\":\"1\",\"channelMultiplier\":2.0,\"channelTypeGid\":9},{\"deviceGid\":10366,\"name\":\"Lights\",\"channelNum\":\"2\",\"channelMultiplier\":1.0,\"channelTypeGid\":12},{\"deviceGid\":10366,\"name\":\"Refrigerator\",\"channelNum\":\"3\",\"channelMultiplier\":1.0,\"channelTypeGid\":10},{\"deviceGid\":10366,\"name\":\"Lean - to RV\",\"channelNum\":\"4\",\"channelMultiplier\":1.0,\"channelTypeGid\":9},{\"deviceGid\":10366,\"name\":\"Well Pump\",\"channelNum\":\"5\",\"channelMultiplier\":2.0,\"channelTypeGid\":19},{\"deviceGid\":10366,\"name\":\"Reservoir Pump\",\"channelNum\":\"6\",\"channelMultiplier\":1.0,\"channelTypeGid\":19},{\"deviceGid\":10366,\"name\":\"Water Heater\",\"channelNum\":\"7\",\"channelMultiplier\":1.0,\"channelTypeGid\":22},{\"deviceGid\":10366,\"name\":\"Main Heater\",\"channelNum\":\"8\",\"channelMultiplier\":2.0,\"channelTypeGid\":11}]}],\"channels\":[{\"deviceGid\":10366,\"name\":null,\"channelNum\":\"1,2,3\",\"channelMultiplier\":1.0,\"channelTypeGid\":null}]}]}";
            var devices = JsonConvert.DeserializeObject<GetDevicesResponse>(json);
        }

        [TestMethod]
        public void GetDeviceListUsagesResponse()
        {
            //var json = "{\"channelUsages\":[{\"deviceGid\":10353,\"channelNum\":\"1,2,3\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":31.863154451887343,\"value\":31.863154451887343}},{\"deviceGid\":10353,\"channelNum\":\"1\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":4.775967052665816,\"value\":4.775967052665816}},{\"deviceGid\":10353,\"channelNum\":\"2\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":2.427270969308747,\"value\":2.427270969308747}},{\"deviceGid\":10353,\"channelNum\":\"3\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.0,\"value\":0.0}},{\"deviceGid\":10353,\"channelNum\":\"4\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":1.3534664807067978,\"value\":1.3534664807067978}},{\"deviceGid\":10353,\"channelNum\":\"5\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":3.1771748607097727,\"value\":3.1771748607097727}},{\"deviceGid\":10353,\"channelNum\":\"6\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.0,\"value\":0.0}},{\"deviceGid\":10353,\"channelNum\":\"7\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.0,\"value\":0.0}},{\"deviceGid\":10353,\"channelNum\":\"8\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":4.610175760895412,\"value\":4.610175760895412}},{\"deviceGid\":10366,\"channelNum\":\"1,2,3\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":-45.571534151539936,\"value\":-45.571534151539936}},{\"deviceGid\":10366,\"channelNum\":\"MainsFromGrid\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":3.9233516733647718,\"value\":3.9233516733647718}},{\"deviceGid\":10366,\"channelNum\":\"MainsToGrid\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":-49.494885824904706,\"value\":-49.494885824904706}},{\"deviceGid\":10366,\"channelNum\":\"1\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.0,\"value\":0.0}},{\"deviceGid\":10366,\"channelNum\":\"2\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.8430876767506864,\"value\":0.8430876767506864}},{\"deviceGid\":10366,\"channelNum\":\"3\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.3919688938197825,\"value\":0.3919688938197825}},{\"deviceGid\":10366,\"channelNum\":\"4\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.8489747851709526,\"value\":0.8489747851709526}},{\"deviceGid\":10366,\"channelNum\":\"5\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":6.8844338570662345,\"value\":6.8844338570662345}},{\"deviceGid\":10366,\"channelNum\":\"6\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":1.3820422099502219,\"value\":1.3820422099502219}},{\"deviceGid\":10366,\"channelNum\":\"7\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.6886588813539346,\"value\":0.6886588813539346}},{\"deviceGid\":10366,\"channelNum\":\"8\",\"usage\":{\"Timestamp\":{\"nano\":0,\"epochSecond\":1623913200},\"Value\":0.0,\"value\":0.0}}]}";
            var json = "{\"deviceListUsages\":{\"instant\":\"2021-08-22T16:17:59Z\",\"scale\":\"1D\",\"devices\":[{\"deviceGid\":10353,\"channelUsages\":[{\"name\":\"Main\",\"usage\":10.282823568678962,\"deviceGid\":10353,\"channelNum\":\"1,2,3\",\"percentage\":100.0,\"nestedDevices\":[]},{\"name\":\"AC Main\",\"usage\":0.0,\"deviceGid\":10353,\"channelNum\":\"1\",\"percentage\":0.0,\"nestedDevices\":[]},{\"name\":\"Refrigerator \",\"usage\":1.2753340820799934,\"deviceGid\":10353,\"channelNum\":\"2\",\"percentage\":12.402566994970195,\"nestedDevices\":[]},{\"name\":\"Dryer\",\"usage\":0.0,\"deviceGid\":10353,\"channelNum\":\"3\",\"percentage\":0.0,\"nestedDevices\":[]},{\"name\":\"Oven\",\"usage\":0.0,\"deviceGid\":10353,\"channelNum\":\"4\",\"percentage\":0.0,\"nestedDevices\":[]},{\"name\":\"Freezer\",\"usage\":1.600049697514375,\"deviceGid\":10353,\"channelNum\":\"5\",\"percentage\":15.560411854075348,\"nestedDevices\":[]},{\"name\":\"AC Up\",\"usage\":0.0,\"deviceGid\":10353,\"channelNum\":\"6\",\"percentage\":0.0,\"nestedDevices\":[]},{\"name\":\"Furnace Up\",\"usage\":0.0,\"deviceGid\":10353,\"channelNum\":\"7\",\"percentage\":0.0,\"nestedDevices\":[]},{\"name\":\"Office\",\"usage\":0.6380334288798438,\"deviceGid\":10353,\"channelNum\":\"8\",\"percentage\":6.204846602865639,\"nestedDevices\":[]},{\"name\":\"Balance\",\"usage\":6.76940636020475,\"deviceGid\":10353,\"channelNum\":\"Balance\",\"percentage\":65.83217454808882,\"nestedDevices\":[]}]},{\"deviceGid\":10366,\"channelUsages\":[{\"name\":\"Main\",\"usage\":5.653400249643592,\"deviceGid\":10366,\"channelNum\":\"1,2,3\",\"percentage\":87.97484219533618,\"nestedDevices\":[]},{\"name\":\"MainsFromGrid\",\"usage\":6.747013050247299,\"deviceGid\":10366,\"channelNum\":\"MainsFromGrid\",\"percentage\":104.9929922125716,\"nestedDevices\":[]},{\"name\":\"MainsToGrid\",\"usage\":-1.0936128006037076,\"deviceGid\":10366,\"channelNum\":\"MainsToGrid\",\"percentage\":-17.018150017235424,\"nestedDevices\":[]},{\"name\":\"Bath Heater\",\"usage\":2.452331251568265E-5,\"deviceGid\":10366,\"channelNum\":\"1\",\"percentage\":3.816171601878189E-4,\"nestedDevices\":[]},{\"name\":\"Lights\",\"usage\":0.43222742495761973,\"deviceGid\":10366,\"channelNum\":\"2\",\"percentage\":6.726065345460077,\"nestedDevices\":[]},{\"name\":\"Refrigerator\",\"usage\":0.24573750508626302,\"deviceGid\":10366,\"channelNum\":\"3\",\"percentage\":3.824020461456364,\"nestedDevices\":[]},{\"name\":\"Lean-to RV\",\"usage\":1.7215561518828075,\"deviceGid\":10366,\"channelNum\":\"4\",\"percentage\":26.789829855377445,\"nestedDevices\":[]},{\"name\":\"Well Pump\",\"usage\":3.0335997811232676,\"deviceGid\":10366,\"channelNum\":\"5\",\"percentage\":47.20707012473614,\"nestedDevices\":[]},{\"name\":\"Reservoir Pump\",\"usage\":0.5692903963050577,\"deviceGid\":10366,\"channelNum\":\"6\",\"percentage\":8.858957541775899,\"nestedDevices\":[]},{\"name\":\"Water Heater\",\"usage\":0.42369622763673465,\"deviceGid\":10366,\"channelNum\":\"7\",\"percentage\":6.593307941968354,\"nestedDevices\":[]},{\"name\":\"Main Heater\",\"usage\":2.3591192563374837E-5,\"deviceGid\":10366,\"channelNum\":\"8\",\"percentage\":3.6711206553852817E-4,\"nestedDevices\":[]},{\"name\":\"TotalUsage\",\"usage\":6.426155601496829,\"deviceGid\":10366,\"channelNum\":\"TotalUsage\",\"percentage\":100.0,\"nestedDevices\":[]},{\"name\":\"Balance\",\"usage\":-0.772755351853237,\"deviceGid\":10366,\"channelNum\":\"Balance\",\"percentage\":-12.025157804663817,\"nestedDevices\":[]}]}],\"energyUnit\":\"KilowattHours\"}}";
            var devicesUsage = JsonConvert.DeserializeObject<GetDeviceListUsagesResponse>(json);
            Assert.IsNotNull(devicesUsage.DeviceListUsages);
        }
    }
}
